<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="../../static/admin.css">
    
   <!--
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
-->
    
</head>
<body>
    <div class="container">
        <aside>
            <div class="top">
                <div class="logo">
                    <h2>Admin Panel</h2>
                </div>
            </div>
            <div class="sidebar">
                <a href="{{ url_for('admin_dashboard') }}">
                    <span class="material-symbols-sharp">grid_view</span>
                    <h3>Dashboard</h3>
                </a>
                <a href="{{ url_for('user_management') }}" class="active">
                    <span class="material-symbols-sharp">person</span>
                    <h3>User Management</h3>
                </a>
                <a href="{{ url_for('adminreports') }}">
                    <span class="material-symbols-sharp">report_gmailerrorred</span>
                    <h3>Reports</h3>
                </a>
                <a href="{{ url_for('user_logs') }}">
                    <span class="material-symbols-sharp">lab_profile</span>
                    <h3>Activity Logs</h3>
                </a>
                <button class="btn btn-light m-1 border" type="button" onclick="confirmLogout()">
                    <span class="material-symbols-sharp">logout</span>
                    <h3>Logout</h3>
                </button>
            </div>
        </aside>

        <main>
            <h1>User Management</h1>
            <div class="recent_reports">

            <h2>Pending Buyer Accounts</h2>
            {% if buyers %}
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Buyer ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Date of Birth</th>
                            <th>Mobile No.</th>
                            <th>Gender</th>
                            <th>Address</th>
                            <th>Valid Id</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for buyer in buyers %}
                        <tr>
                            <td>{{ buyer.id_no }}</td>
                            <td>{{ buyer.name }}</td>
                            <td>{{ buyer.email }}</td>
                            <td>{{ buyer.dateofbirth }}</td>
                            <td>{{ buyer.mobile_no }}</td>
                            <td>{{ buyer.gender }}</td>
                            <td>{{ buyer.region }} {{ buyer.province }} {{ buyer.city }} {{ buyer.brgy }}</td>
                            <td>
                                {% if buyer['image_path'] %}
                                <img src="{{ url_for('static', filename=buyer['image_path'].split('static/')[-1]) }}" alt="Valid ID" width="150" height="90">
                            {% else %}
                                <span>No image uploaded</span>
                            {% endif %}
                            
                            </td>
                            <td>{{ buyer.status }}</td>
                            <td>
                                <form action="/admin/user-management" method="POST" style="display: inline-block;">
                                    <input type="hidden" name="account_type" value="buyer">
                                    <input type="hidden" name="account_id" value="{{ buyer.id_no }}">
                                    <input type="hidden" name="account_email" value="{{ buyer.email }}">
                                    <button class="approvebtn btn btn-primary" type="submit" name="action" value="Approve">Approve</button>
                                    <button class="rejectbtn btn btn-danger" type="submit" name="action" value="Reject" onclick="return confirm('Are you sure you want to reject this account?')">Reject</button>
                                    
                                    <textarea name="reason" placeholder="Reason for rejection (optional)" class="form-control mt-2"></textarea>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No pending buyer accounts.</p>
            {% endif %}
            </div>

            <div class="recent_reports">
            <h2>Pending Seller Accounts</h2>
            {% if sellers %}
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Seller ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Date of Birth</th>
                            <th>Mobile No.</th>
                            <th>Gender</th>
                            <th>Address</th>
                            <th>Valid Id</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for seller in sellers %}
                        <tr>
                            <td>{{ seller.sellerID }}</td>
                            <td>{{ seller.name }}</td>
                            <td>{{ seller.email }}</td>
                            <td>{{ seller.dateofbirth }}</td>
                            <td>{{ seller.number }}</td>
                            <td>{{ seller.gender}}</td>
                            <td>{{ seller.region }} {{ seller.province }} {{ seller.city }} {{ seller.brgy }}</td>
                            <td>
                                <img src="{{ url_for('static', filename=seller['image_path'].split('static/')[-1]) }}" alt="Valid ID" width="150" height="90"> 
                            </td>
                            <td>{{ seller.status }}</td>
                            <td>
                                <form action="/admin/user-management" method="POST" style="display: inline-block;">
                                    <input type="hidden" name="account_type" value="seller">
                                    <input type="hidden" name="account_id" value="{{ seller.sellerID }}">
                                    <input type="hidden" name="account_email" value="{{ seller.email }}"> <!-- Add email field -->
                                    
                                    <button class="approvebtn" type="submit" name="action" value="Approve">Approve</button>
                                    <button class="rejectbtn" type="submit" name="action" value="Reject" onclick="return confirm('Are you sure you want to reject this account?')">Reject</button>
                                    
                                    <textarea name="reason" placeholder="Reason for rejection (optional)" class="form-control mt-2"></textarea>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No pending seller accounts.</p>
            {% endif %}
            </div>

             <div class="recent_reports">
            <h2>Pending Courier Accounts</h2>
            {% if riders %}
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Courier ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Date of Birth</th>
                            <th>Mobile No.</th>
                            <th>Gender</th>
                            <th>Address</th>
                            <th>Valid Id</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for rider in riders %}
                        <tr>
                            <td>{{ rider.id_no }}</td>
                            <td>{{ rider.name }}</td>
                            <td>{{ rider.email }}</td>
                            <td>{{ rider.dateofbirth }}</td>
                            <td>{{ rider.mobile_no }}</td>
                            <td>{{ rider.gender}}</td>
                            <td>{{ rider.region }} {{ rider.province }} {{ rider.city }} {{ rider.brgy }}</td>
                            <td>
                                <img src="{{ url_for('static', filename=rider['image_path'].split('static/')[-1]) }}" alt="Valid ID" width="150" height="90"> 
                            </td>
                            <td>{{ rider.status }}</td>
                            <td>
                                <form action="/admin/user-management" method="POST" style="display: inline-block;">
                                    <input type="hidden" name="account_type" value="rider">
                                    <input type="hidden" name="account_id" value="{{ rider.id_no }}">
                                    <input type="hidden" name="account_email" value="{{ rider.email }}"> <!-- Add email field -->
                                    
                                    <button class="approvebtn" type="submit" name="action" value="Approve">Approve</button>
                                    <button class="rejectbtn" type="submit" name="action" value="Reject" onclick="return confirm('Are you sure you want to reject this account?')">Reject</button>
                                    
                                    <textarea name="reason" placeholder="Reason for rejection (optional)" class="form-control mt-2"></textarea>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No pending courier accounts.</p>
            {% endif %}
            </div>
        </main>
    </div>

    <script>
        //logout
        function confirmLogout() {
            // Display a confirmation dialog
        if (confirm("Are you sure you want to log out?")) {
                // Redirect to the logout route if the user confirms
            window.location.href = "{{ url_for('logout') }}";
            }
        }

    </script>
</body>
</html>
